---
const items = [
  { href: "/", text: "Principio" },
  { href: "/photos", text: "Photos" },
  { href: "/questions-and-answers", text: "Q&A" },
  { href: "/does-it-worth", text: "¿Vale la pena? (opinión personal)" },
  { href: "/timeline", text: "Timeline photo Gallery" },
];

const currentPath = Astro.url.pathname;

---

<header class="w-full py-4 px-8 sticky top-0 z-50 left-0 right-0 headerBgGradient transition-all">
    <ul class="flex flex-row justify-between items-center ">
      {items.map((item, index) => {
        const isActive = currentPath === item.href;
        return (
          <li class="text-lg">
            <a
              href={item.href}
              class={`anchors-header no-underline rounded-xl font-nunito p-3 transition-all duration-300
                ${
                  isActive && index === items.length - 1 ? "text-white bg-rose" 
                  : isActive && index !=- items.length - 1 ? "text-black bg-yellow"
                   
                    : index === items.length - 1
                    ? "text-rose hover:bg-rose hover:text-white"
                    : "text-black hover:bg-yellow"
                }`}
            >
              {item.text}
            </a>
          </li>
        );
      })}
    </ul>
  </header>
  <script>

    function onScroll(header : HTMLElement, anchors : NodeListOf<Element>){
      const scrollTop = window.scrollY;
      if (scrollTop > header.clientHeight) {
        header.classList.add("headerBgGradientDark");
        for (let i = 0; i < anchors.length; i++) {
          anchors[i].classList.add("anchorScroll");
        }
        
      } else {
        // header.classList.add("headerBgGradient");
        header.classList.remove("headerBgGradientDark");
        for (let i = 0; i < anchors.length; i++) {
          anchors[i].classList.remove("anchorScroll");
        }
      }
    }

    function init(){
      const header = document.querySelector("header");
    const anchors = document.querySelectorAll(".anchors-header");
    if (!header) return;

    window.addEventListener("scroll", () => {
      onScroll(header, anchors);
    });

    document.addEventListener("astro:before-swap", () => {
      window.removeEventListener("scroll", () => {
        onScroll(header, anchors);
      });
    })

    }

   document.addEventListener("DOMContentLoaded", () => {
     init();
   });

   document.addEventListener("astro:after-swap", () => {
     init();
   });

  </script>